// Function to display scan results
function displayScanResults(data) {
const resultsContainer = document.getElementById('results');
resultsContainer.innerHTML = ''; // Clear previous results

if (data.error) {
resultsContainer.innerHTML = `<p>Error: ${data.error.message}</p>`;
return;
}

// Display scan report
const { data: scanData } = data;
const fileReport = `
<h4>Scan Report for File</h4>
<p>File Name: ${scanData.attributes.name}</p>
<p>File Size: ${scanData.attributes.size} bytes</p>
<p>Scan Date: ${new Date(scanData.attributes.last_analysis_date * 1000).toLocaleString()}</p>
<h5>Analysis Results:</h5>
<ul>
  ${Object.entries(scanData.attributes.last_analysis_results).map(([vendor, result]) => `
  <li>${vendor}: ${result.category} (${result.result || 'No result'})</li>
  `).join('')}
</ul>
`;
resultsContainer.innerHTML = fileReport;  // Insert results into the container
}